pipeline {
 agent any
 environment {
        mavenHome = tool 'maven'
    }
 tools {
  jdk 'openjdk-17'
    }
 stages {
            stage('Build'){
                steps {
                    sh "mvn clean install -DskipTests"
                }
            }
            stage('Sonarqube') {
                environment {
                    scannerHome = tool 'SonarQubeScanner'
                }
                steps {
                    withSonarQubeEnv('sonarqube') {
                    sh "mvn sonar:sonar -Dsonar.projectKey=jenkins-pms -Dsonar.host.url=http://35.244.27.133:9000/sonar -Dsonar.token=sqa_02cdfc9890929a72e5715a174fe6862997e9e8bb -Dsonar.java.binaries=target/**/*"
                }
                /*
                commenting this to check and see a success of the pipeline of the sonar build is a success
                timeout(time: 10, unit: 'MINUTES') {
                    waitForQualityGate abortPipeline: true
                }
                */
                }
            }
            /*
            Commented to remove docker image build stage from jenkins pipeline
            stage ('Build docker image') {
                steps {
                    sh 'docker build -t xn-poc/pms .'
                }
            }
            */
        }
}